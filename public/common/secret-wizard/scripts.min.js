"use strict";!function(){var e,a,t;function n(){var t=document.createElement("div"),e=(t.classList.add("wizard"),document.body.appendChild(t),t),n=function(){a.addEventListener("submit",d),a.querySelector("textarea").focus(),document.body.classList.add("is-wizard")},e=((a=document.createElement("form")).classList.add("wizard__form"),a.setAttribute("method","POST"),a.setAttribute("action","/"),e.appendChild(a),(e=document.createElement("h2")).classList.add("wizard__title"),e.textContent=knife_custom_wizard.title.start,a.appendChild(e),(e=document.createElement("h5")).classList.add("wizard__excerpt"),e.textContent=knife_custom_wizard.excerpt,a.appendChild(e),(e=document.createElement("textarea")).classList.add("wizard__textarea"),e.setAttribute("placeholder",knife_custom_wizard.placeholder),a.appendChild(e),(e=document.createElement("button")).classList.add("wizard__submit"),e.setAttribute("type","submit"),e.textContent="Узнать ответ",a.appendChild(e),n(),t.addEventListener("keydown",function(e){"Escape"==e.key&&t&&document.body.removeChild(t)}),document.createElement("button"));e.classList.add("wizard__closer"),e.setAttribute("type","button"),t.appendChild(e),e.addEventListener("click",function(e){e.preventDefault(),document.body.removeChild(t)})}function d(e){e.preventDefault();var d=new XMLHttpRequest,e=(d.open("POST",knife_custom_wizard.url,!0),d.setRequestHeader("Content-Type","application/json"),d.onload=function(){try{var e=JSON.parse(d.responseText);if(200!==d.status)return r(e.message||knife_custom_wizard.error);else{var t=e.message;for(;a.firstChild;)a.removeChild(a.lastChild);var n=document.createElement("h5"),n=(n.classList.add("wizard__title"),n.textContent=knife_custom_wizard.title.result,a.appendChild(n),document.createElement("p"));n.classList.add("wizard__answer"),n.textContent=t,a.appendChild(n);return}}catch(e){return console.error(e),r(knife_custom_wizard.error)}},{question:a.querySelector("textarea").value});d.send(JSON.stringify(e))}function r(e){var t=document.createElement("p");t.classList.add("wizard__warning"),t.textContent=e,a.appendChild(t)}"undefined"!=typeof knife_custom_wizard&&null!==(e=document.querySelector(".header"))&&(a=null,t=0,e.addEventListener("click",function(){null===t||++t<2||(t=null,n())}))}();